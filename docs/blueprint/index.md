# Table of Contents

1. [Introduction](01-introduction.md#1-introduction)

- [1.1 Purpose](01-introduction.md#11-purpose)
- [1.2 Core Objectives](01-introduction.md#12-core-objectives)
- [1.3 Target Use Cases](01-introduction.md#13-target-use-cases)

2. [Coding Style & Conventions](02-coding-style-conventions.md#2-coding-style-conventions)

- [2.1 Overview](02-coding-style-conventions.md#21-overview)
- [2.2 General Conventions](02-coding-style-conventions.md#22-general-conventions)
- [2.3 Formatting and Layout](02-coding-style-conventions.md#23-formatting-and-layout)
- [2.4 Naming Conventions](02-coding-style-conventions.md#24-naming-conventions)
- [2.5 Logging (LoggerMessage Source Generator Pattern)](02-coding-style-conventions.md#25-logging-loggermessage-source-generator-pattern)
- [2.6 Disposal Pattern](02-coding-style-conventions.md#26-disposal-pattern)
- [2.7 StyleCop Enforcement Summary](02-coding-style-conventions.md#27-stylecop-enforcement-summary)
- [2.8 StyleCop Configuration (`stylecop.json`)](02-coding-style-conventions.md#28-stylecop-configuration-stylecopjson)

3. [System Architecture](03-system-architecture.md#3-system-architecture)

- [3.1 High-Level Architecture](03-system-architecture.md#31-high-level-architecture)
- [3.1.1 Component Diagram (Logical Layers in Single Project)](03-system-architecture.md#311-component-diagram-logical-layers-in-single-project)
- [3.1.2 Communication Flow Example (MQTT Play Command)](03-system-architecture.md#312-communication-flow-example-mqtt-play-command)
- [3.2 Key Components (Roles within Folders)](03-system-architecture.md#32-key-components-roles-within-folders)
- [3.2.1 `/Core` Layer](03-system-architecture.md#321-core-layer)
- [3.2.2 `/Server` Layer](03-system-architecture.md#322-server-layer)
- [3.2.3 `/Infrastructure` Layer](03-system-architecture.md#323-infrastructure-layer)
- [3.2.4 `/Api` Layer](03-system-architecture.md#324-api-layer)
- [3.2.5 `/Worker` Layer](03-system-architecture.md#325-worker-layer)

4. [Core Components & State Management](04-core-components-state-management.md#4-core-components-state-management)

- [4.1 Core Structure Overview](04-core-components-state-management.md#41-core-structure-overview)
- [4.2 State Management](04-core-components-state-management.md#42-state-management)
- [4.2.1 Immutable State Objects (Canonical Definitions)](04-core-components-state-management.md#421-immutable-state-objects-canonical-definitions)
- [4.2.2 Thread Synchronization](04-core-components-state-management.md#422-thread-synchronization)
- [4.2.3 State Types Managed & Ownership](04-core-components-state-management.md#423-state-types-managed-ownership)
- [4.2.4 State Change Flow](04-core-components-state-management.md#424-state-change-flow)
- [4.3 Event-Driven Architecture](04-core-components-state-management.md#43-event-driven-architecture)
- [4.4 Startup Sequence](04-core-components-state-management.md#44-startup-sequence)
- [4.5 Error Handling Strategy](04-core-components-state-management.md#45-error-handling-strategy)

5. [Cross-Cutting Concerns](05-cross-cutting-concerns.md#5-cross-cutting-concerns)

- [5.1 Error Handling Strategy](05-cross-cutting-concerns.md#51-error-handling-strategy)
- [5.1.1 Result Pattern Implementation (Canonical Definition)](05-cross-cutting-concerns.md#511-result-pattern-implementation-canonical-definition)
- [5.1.2 Usage in Services](05-cross-cutting-concerns.md#512-usage-in-services)
- [5.2 Logging Strategy](05-cross-cutting-concerns.md#52-logging-strategy)
- [5.3 Instrumentation and Metrics](05-cross-cutting-concerns.md#53-instrumentation-and-metrics)
- [5.4 Validation](05-cross-cutting-concerns.md#54-validation)
- [5.5 Interplay](05-cross-cutting-concerns.md#55-interplay)

6. [Resilience Configuration System](06-resilience-configuration.md#6-resilience-configuration-system)

- [6.1 Overview](06-resilience-configuration.md#61-overview)
- [6.2 Architecture Overview](06-resilience-configuration.md#62-architecture-overview)
- [6.2.1 Resilience Configuration Structure](06-resilience-configuration.md#621-resilience-configuration-structure)
- [6.2.2 Policy Types](06-resilience-configuration.md#622-policy-types)
- [6.2.3 Resilience Policy Factory](06-resilience-configuration.md#623-resilience-policy-factory)
- [6.3 Environment Variable Structure](06-resilience-configuration.md#63-environment-variable-structure)
- [6.3.1 Variable Naming Convention](06-resilience-configuration.md#631-variable-naming-convention)
- [6.3.2 KNX Service Resilience Configuration](06-resilience-configuration.md#632-knx-service-resilience-configuration)
- [6.3.2.1 Connection Policy Environment Variables](06-resilience-configuration.md#6321-connection-policy-environment-variables)
- [6.3.2.2 Operation Policy Environment Variables](06-resilience-configuration.md#6322-operation-policy-environment-variables)
- [6.3.3 MQTT Service Resilience Configuration](06-resilience-configuration.md#633-mqtt-service-resilience-configuration)
- [6.3.3.1 Connection Policy Environment Variables](06-resilience-configuration.md#6331-connection-policy-environment-variables)
- [6.3.3.2 Operation Policy Environment Variables](06-resilience-configuration.md#6332-operation-policy-environment-variables)
- [6.3.4 Snapcast Service Resilience Configuration](06-resilience-configuration.md#634-snapcast-service-resilience-configuration)
- [6.3.4.1 Connection Policy Environment Variables](06-resilience-configuration.md#6341-connection-policy-environment-variables)
- [6.3.4.2 Operation Policy Environment Variables](06-resilience-configuration.md#6342-operation-policy-environment-variables)
- [6.4 Configuration Classes](06-resilience-configuration.md#64-configuration-classes)
- [6.4.1 ResilienceConfig Class](06-resilience-configuration.md#641-resilienceconfig-class)
- [6.4.2 PolicyConfig Class](06-resilience-configuration.md#642-policyconfig-class)
- [6.5 Service Integration](06-resilience-configuration.md#65-service-integration)
- [6.5.1 Service Implementation Pattern](06-resilience-configuration.md#651-service-implementation-pattern)
- [6.5.2 Configuration Validation](06-resilience-configuration.md#652-configuration-validation)
- [6.6 Backoff Strategies](06-resilience-configuration.md#66-backoff-strategies)
- [6.6.1 Linear Backoff](06-resilience-configuration.md#661-linear-backoff)
- [6.6.2 Exponential Backoff](06-resilience-configuration.md#662-exponential-backoff)
- [6.6.3 Constant Backoff](06-resilience-configuration.md#663-constant-backoff)
- [6.7 Environment-Specific Configurations](06-resilience-configuration.md#67-environment-specific-configurations)
- [6.7.1 Development Environment](06-resilience-configuration.md#671-development-environment)
- [6.7.2 Production Environment](06-resilience-configuration.md#672-production-environment)
- [6.7.3 High-Latency Network Environment](06-resilience-configuration.md#673-high-latency-network-environment)
- [6.8 Docker Compose Integration](06-resilience-configuration.md#68-docker-compose-integration)
- [6.8.1 Production Docker Compose Example](06-resilience-configuration.md#681-production-docker-compose-example)
- [6.9 Monitoring and Observability](06-resilience-configuration.md#69-monitoring-and-observability)
- [6.9.1 Resilience Metrics](06-resilience-configuration.md#691-resilience-metrics)
- [6.9.2 Logging Integration](06-resilience-configuration.md#692-logging-integration)
- [6.10 Performance Considerations](06-resilience-configuration.md#610-performance-considerations)
- [6.10.1 Impact Analysis](06-resilience-configuration.md#6101-impact-analysis)
- [6.10.2 Tuning Guidelines](06-resilience-configuration.md#6102-tuning-guidelines)
- [6.11 Benefits](06-resilience-configuration.md#611-benefits)
- [6.11.1 Operational Flexibility](06-resilience-configuration.md#6111-operational-flexibility)
- [6.11.2 Reliability Improvements](06-resilience-configuration.md#6112-reliability-improvements)
- [6.11.3 Maintainability](06-resilience-configuration.md#6113-maintainability)

7. [Fault Tolerance Implementation (Infrastructure Layer)](07-fault-tolerance-implementation-infrastructure-layer.md#7-fault-tolerance-implementation-infrastructure-layer)

- [7.1 Overview](07-fault-tolerance-implementation-infrastructure-layer.md#71-overview)
- [7.2 Polly Integration and Policy Definitions](07-fault-tolerance-implementation-infrastructure-layer.md#72-polly-integration-and-policy-definitions)
- [7.3 Resilience Strategies for Key Components](07-fault-tolerance-implementation-infrastructure-layer.md#73-resilience-strategies-for-key-components)
- [7.3.1 Snapcast Service Resilience (`SnapcastService`)](07-fault-tolerance-implementation-infrastructure-layer.md#731-snapcast-service-resilience-snapcastservice)
- [7.3.2 MQTT Service Resilience (`MqttService`)](07-fault-tolerance-implementation-infrastructure-layer.md#732-mqtt-service-resilience-mqttservice)
- [7.3.3 KNX Service Resilience (`KnxService`)](07-fault-tolerance-implementation-infrastructure-layer.md#733-knx-service-resilience-knxservice)
- [7.3.4 HTTP Client Resilience (Subsonic, etc.)](07-fault-tolerance-implementation-infrastructure-layer.md#734-http-client-resilience-subsonic-etc)
- [7.4 Resilience Registration in DI Container](07-fault-tolerance-implementation-infrastructure-layer.md#74-resilience-registration-in-di-container)

8. [Security Implementation (API Layer)](08-security-implementation-api-layer.md#8-security-implementation-api-layer)

- [8.1 Security Philosophy & Threat Model](08-security-implementation-api-layer.md#81-security-philosophy-threat-model)
- [8.2 API Key Authentication](08-security-implementation-api-layer.md#82-api-key-authentication)
- [8.2.1 API Key Configuration](08-security-implementation-api-layer.md#821-api-key-configuration)
- [8.2.2 API Key Authentication Implementation (ASP.NET Core)](08-security-implementation-api-layer.md#822-api-key-authentication-implementation-aspnet-core)
- [8.2.3 API Security Registration (ASP.NET Core)](08-security-implementation-api-layer.md#823-api-security-registration-aspnet-core)
- [8.3 Security Best Practices Applied](08-security-implementation-api-layer.md#83-security-best-practices-applied)
- [8.4 Security Logging (`ISecurityLogger` / `SecurityLogger`)](08-security-implementation-api-layer.md#84-security-logging-isecuritylogger-securitylogger)

9. [Configuration System](10-configuration-system.md#9-configuration-system)

- [9.1 Architecture Overview](10-configuration-system.md#91-architecture-overview)
- [9.1.1 Unified Configuration Structure](10-configuration-system.md#911-unified-configuration-structure)
- [9.1.2 EnvoyConfig Features Utilized](10-configuration-system.md#912-envoyconfig-features-utilized)
- [9.2 Environment Variable Structure](10-configuration-system.md#92-environment-variable-structure)
- [9.2.1 System Configuration](10-configuration-system.md#921-system-configuration)
- [9.2.2 Telemetry Configuration](10-configuration-system.md#922-telemetry-configuration)
- [9.2.3 API Configuration](10-configuration-system.md#923-api-configuration)
- [9.2.4 Services Configuration](10-configuration-system.md#924-services-configuration)
- [9.2.4.1 Streamlined Audio Configuration](10-configuration-system.md#9241-streamlined-audio-configuration)
9. [KNX Connection Policy (for establishing connections)](10-configuration-system.md#9-knx-connection-policy-for-establishing-connections)

9. [KNX Operation Policy (for individual operations)](10-configuration-system.md#9-knx-operation-policy-for-individual-operations)

9. [MQTT Connection Policy](10-configuration-system.md#9-mqtt-connection-policy)

9. [MQTT Operation Policy](10-configuration-system.md#9-mqtt-operation-policy)

9. [Snapcast Connection Policy](10-configuration-system.md#9-snapcast-connection-policy)

9. [Snapcast Operation Policy](10-configuration-system.md#9-snapcast-operation-policy)

9. [Zone 1 Configuration](10-configuration-system.md#9-zone-1-configuration)

9. [Zone 1 MQTT Configuration](10-configuration-system.md#9-zone-1-mqtt-configuration)

9. [Zone 1 KNX Configuration](10-configuration-system.md#9-zone-1-knx-configuration)

9. [Zone 2 Configuration](10-configuration-system.md#9-zone-2-configuration)

9. [Client 1 Configuration](10-configuration-system.md#9-client-1-configuration)

9. [Client 1 MQTT Configuration](10-configuration-system.md#9-client-1-mqtt-configuration)

9. [Client 1 KNX Configuration](10-configuration-system.md#9-client-1-knx-configuration)

9. [Client 2 Configuration](10-configuration-system.md#9-client-2-configuration)

9. [Radio Station 1](10-configuration-system.md#9-radio-station-1)

9. [Radio Station 2](10-configuration-system.md#9-radio-station-2)

9. [Radio Station 3](10-configuration-system.md#9-radio-station-3)


10. [API Specification](11-api-specification.md#10-api-specification)

- [10.1 API Design Philosophy](11-api-specification.md#101-api-design-philosophy)
- [10.2 Authentication and Authorization](11-api-specification.md#102-authentication-and-authorization)
- [10.3 Server Configuration](11-api-specification.md#103-server-configuration)
- [10.4 API Structure (`/api/v1/`)](11-api-specification.md#104-api-structure-apiv1)
- [10.4.1 System Endpoints](11-api-specification.md#1041-system-endpoints)
- [10.4.1.1 **Health Endpoints:**](11-api-specification.md#10411-health-endpoints)
- [10.4.2 Zone Endpoints](11-api-specification.md#1042-zone-endpoints)
- [10.4.3 Client Endpoints](11-api-specification.md#1043-client-endpoints)
- [10.4.4 Media Management Endpoints](11-api-specification.md#1044-media-management-endpoints)
- [10.5 Request and Response Format](11-api-specification.md#105-request-and-response-format)
- [10.5.1 Modern Direct Response Design](11-api-specification.md#1051-modern-direct-response-design)
- [10.5.2 Legacy Response Wrapper (Deprecated)](11-api-specification.md#1052-legacy-response-wrapper-deprecated)
- [10.6 HTTP Status Codes](11-api-specification.md#106-http-status-codes)
- [10.7 Pagination, Filtering, and Sorting](11-api-specification.md#107-pagination-filtering-and-sorting)
- [10.8 Webhooks and Event Streams (Optional / Future)](11-api-specification.md#108-webhooks-and-event-streams-optional-future)
- [10.9 HATEOAS Links (Optional)](11-api-specification.md#109-hateoas-links-optional)
- [10.10 API Implementation Notes](11-api-specification.md#1010-api-implementation-notes)
- [10.11 API Versioning](11-api-specification.md#1011-api-versioning)
- [10.12 API Documentation (Swagger/OpenAPI)](11-api-specification.md#1012-api-documentation-swaggeropenapi)

11. [Infrastructure Services Implementation](12-infrastructure-services-implementation.md#11-infrastructure-services-implementation)

- [11.1 Snapcast Integration (`/Infrastructure/Snapcast/`)](12-infrastructure-services-implementation.md#111-snapcast-integration-infrastructuresnapcast)
- [11.1.1 `SnapcastService`](12-infrastructure-services-implementation.md#1111-snapcastservice)
- [11.1.2 `SnapcastStateRepository`](12-infrastructure-services-implementation.md#1112-snapcaststaterepository)
- [11.2 KNX Integration (`/Infrastructure/Knx/KnxService.cs`)](12-infrastructure-services-implementation.md#112-knx-integration-infrastructureknxknxservicecs)
- [11.3 MQTT Integration (`/Infrastructure/Mqtt/MqttService.cs`)](12-infrastructure-services-implementation.md#113-mqtt-integration-infrastructuremqttmqttservicecs)
- [11.4 Subsonic Integration (`/Infrastructure/Subsonic/SubsonicService.cs`)](12-infrastructure-services-implementation.md#114-subsonic-integration-infrastructuresubsonicsubsonicservicecs)
- [11.5 Media Playback (`/Infrastructure/Audio/MediaPlayerService.cs`)](12-infrastructure-services-implementation.md#115-media-playback-infrastructureaudiomediaplayerservicecs)
- [11.5.1 Streamlined Audio Configuration Integration](12-infrastructure-services-implementation.md#1151-streamlined-audio-configuration-integration)

12. [Metrics and Telemetry (Infrastructure Layer)](13-metrics-and-telemetry-infrastructure-layer.md#12-metrics-and-telemetry-infrastructure-layer)

- [12.1 Overview](13-metrics-and-telemetry-infrastructure-layer.md#121-overview)
- [12.2 Configuration](13-metrics-and-telemetry-infrastructure-layer.md#122-configuration)
- [12.2.1 Environment Variables](13-metrics-and-telemetry-infrastructure-layer.md#1221-environment-variables)
- [12.2.2 Backend-Specific Examples](13-metrics-and-telemetry-infrastructure-layer.md#1222-backend-specific-examples)
- [12.3 Implementation](13-metrics-and-telemetry-infrastructure-layer.md#123-implementation)
- [12.3.1 TelemetryConfig Class](13-metrics-and-telemetry-infrastructure-layer.md#1231-telemetryconfig-class)
- [12.3.2 OpenTelemetry Setup](13-metrics-and-telemetry-infrastructure-layer.md#1232-opentelemetry-setup)
- [12.4 Scope](13-metrics-and-telemetry-infrastructure-layer.md#124-scope)
- [12.5 Telemetry Types](13-metrics-and-telemetry-infrastructure-layer.md#125-telemetry-types)
- [12.5.1 Traces](13-metrics-and-telemetry-infrastructure-layer.md#1251-traces)
- [12.5.2 Metrics](13-metrics-and-telemetry-infrastructure-layer.md#1252-metrics)
- [12.5.3 Logs](13-metrics-and-telemetry-infrastructure-layer.md#1253-logs)
- [12.6 Benefits](13-metrics-and-telemetry-infrastructure-layer.md#126-benefits)
- [12.6.1 Vendor Neutrality](13-metrics-and-telemetry-infrastructure-layer.md#1261-vendor-neutrality)
- [12.6.2 Operational Benefits](13-metrics-and-telemetry-infrastructure-layer.md#1262-operational-benefits)
- [12.6.3 Development Experience](13-metrics-and-telemetry-infrastructure-layer.md#1263-development-experience)
- [12.7 OpenTelemetry Setup (DI / `/Worker/DI/ObservabilityExtensions.cs`)](13-metrics-and-telemetry-infrastructure-layer.md#127-opentelemetry-setup-di-workerdiobservabilityextensionscs)
- [12.8 Custom Metrics (`IMetricsService` / `OpenTelemetryMetricsService`)](13-metrics-and-telemetry-infrastructure-layer.md#128-custom-metrics-imetricsservice-opentelemetrymetricsservice)
- [12.9 Manual Tracing Instrumentation](13-metrics-and-telemetry-infrastructure-layer.md#129-manual-tracing-instrumentation)
- [12.10 Logging Correlation](13-metrics-and-telemetry-infrastructure-layer.md#1210-logging-correlation)

13. [Zone-to-Client Mapping Strategy (Server Layer)](14-zone-to-client-mapping-strategy-server-layer.md#13-zone-to-client-mapping-strategy-server-layer)

- [13.1 Overview](14-zone-to-client-mapping-strategy-server-layer.md#131-overview)
- [13.2 Core Principles](14-zone-to-client-mapping-strategy-server-layer.md#132-core-principles)
- [13.3 Implementation (`ZoneManager`, `ClientManager`, `SnapcastService`)](14-zone-to-client-mapping-strategy-server-layer.md#133-implementation-zonemanager-clientmanager-snapcastservice)
- [13.3.1 `ZoneManager` (/Server/Managers/ZoneManager.cs)](14-zone-to-client-mapping-strategy-server-layer.md#1331-zonemanager-servermanagerszonemanagercs)
- [13.3.2 `ClientManager` (/Server/Managers/ClientManager.cs)](14-zone-to-client-mapping-strategy-server-layer.md#1332-clientmanager-servermanagersclientmanagercs)
- [13.3.3 `SnapcastService` (/Infrastructure/Snapcast/SnapcastService.cs)](14-zone-to-client-mapping-strategy-server-layer.md#1333-snapcastservice-infrastructuresnapcastsnapcastservicecs)
- [13.4 Cortex.Mediator Notifications for Synchronization](14-zone-to-client-mapping-strategy-server-layer.md#134-cortexmediator-notifications-for-synchronization)
- [13.5 Data Contracts (`ClientState`, `ZoneState`)](14-zone-to-client-mapping-strategy-server-layer.md#135-data-contracts-clientstate-zonestate)
- [13.6 Registration in DI Container](14-zone-to-client-mapping-strategy-server-layer.md#136-registration-in-di-container)

14. [Command Framework](15-command-framework.md#14-command-framework)

- [14.1 Overview of Command Structure](15-command-framework.md#141-overview-of-command-structure)
- [14.2 Global Commands and Status](15-command-framework.md#142-global-commands-and-status)
- [14.2.1 Global Functionality (Status Only)](15-command-framework.md#1421-global-functionality-status-only)
- [14.2.2 Global MQTT Implementation](15-command-framework.md#1422-global-mqtt-implementation)
- [14.2.3 Global MQTT Last Will and Testament (LWT)](15-command-framework.md#1423-global-mqtt-last-will-and-testament-lwt)
- [14.3 Zone Commands and Status](15-command-framework.md#143-zone-commands-and-status)
- [14.3.1 Zone Functionality](15-command-framework.md#1431-zone-functionality)
- [14.3.2 Zone MQTT Implementation](15-command-framework.md#1432-zone-mqtt-implementation)
- [14.3.2.1 Zone Command Topics](15-command-framework.md#14321-zone-command-topics)
- [14.3.2.2 Zone Status Topics (Read-Only)](15-command-framework.md#14322-zone-status-topics-read-only)
- [14.3.2.3 System-Level Topics (Discovery & Global Status)](15-command-framework.md#14323-system-level-topics-discovery-global-status)
- [14.3.2.4 Payloads for `{zoneBaseTopic}control/set`](15-command-framework.md#14324-payloads-for-zonebasetopiccontrolset)
- [14.3.2.5 Standardized Payload Patterns](15-command-framework.md#14325-standardized-payload-patterns)
- [14.3.2.6 Status Values for `{zoneBaseTopic}control`](15-command-framework.md#14326-status-values-for-zonebasetopiccontrol)
- [14.3.3 Zone KNX Implementation](15-command-framework.md#1433-zone-knx-implementation)
- [14.3.3.1 KNX Zone Command Group Addresses](15-command-framework.md#14331-knx-zone-command-group-addresses)
- [14.3.3.2 KNX Zone Status Group Addresses](15-command-framework.md#14332-knx-zone-status-group-addresses)
- [14.4 Client Commands and Status](15-command-framework.md#144-client-commands-and-status)
- [14.4.1 Client Functionality](15-command-framework.md#1441-client-functionality)
- [14.4.2 Client MQTT Implementation](15-command-framework.md#1442-client-mqtt-implementation)
- [14.4.2.1 Client Command Topics (`/set`)](15-command-framework.md#14421-client-command-topics-set)
- [14.4.2.2 Client Status Topics (Read-Only)](15-command-framework.md#14422-client-status-topics-read-only)
- [14.4.3 Client KNX Implementation](15-command-framework.md#1443-client-knx-implementation)
- [14.4.3.1 KNX Client Command Group Addresses](15-command-framework.md#14431-knx-client-command-group-addresses)
- [14.4.3.2 KNX Client Status Group Addresses](15-command-framework.md#14432-knx-client-status-group-addresses)
- [14.5 Zone and Client State Objects (JSON Examples)](15-command-framework.md#145-zone-and-client-state-objects-json-examples)
- [14.5.1 Complete Zone State (JSON)](15-command-framework.md#1451-complete-zone-state-json)
- [14.5.2 Complete Client State (JSON)](15-command-framework.md#1452-complete-client-state-json)

15. [MQTT Integration](15a-mqtt-topic-oversight.md#15-mqtt-integration)

- [15.1 Topic Structure](15a-mqtt-topic-oversight.md#151-topic-structure)
- [15.2 Status Id & Command Id Mapping](15a-mqtt-topic-oversight.md#152-status-id-command-id-mapping)
- [15.2.1 System Level](15a-mqtt-topic-oversight.md#1521-system-level)
- [15.2.2 Zone Level](15a-mqtt-topic-oversight.md#1522-zone-level)
- [15.2.3 Client Level](15a-mqtt-topic-oversight.md#1523-client-level)

16. [b. Command Framework Consistency Framework](15b-consistency-framework.md#16-b-command-framework-consistency-framework)

- [16.1 b.1. Overview](15b-consistency-framework.md#161-b1-overview)
- [16.1.1 b.1.1. Problem Statement](15b-consistency-framework.md#1611-b11-problem-statement)
- [16.1.2 b.1.2. Design Principles](15b-consistency-framework.md#1612-b12-design-principles)
- [16.2 b.2. Architecture](15b-consistency-framework.md#162-b2-architecture)
- [16.2.1 b.2.1. Validation Layers](15b-consistency-framework.md#1621-b21-validation-layers)
- [16.2.2 b.2.2. Test-Based Validation Strategy](15b-consistency-framework.md#1622-b22-test-based-validation-strategy)
- [16.3 b.3. Consistency Test Categories](15b-consistency-framework.md#163-b3-consistency-test-categories)
- [16.3.1 b.3.1. Core Registry Tests](15b-consistency-framework.md#1631-b31-core-registry-tests)
- [16.3.2 b.3.2. Protocol Implementation Tests](15b-consistency-framework.md#1632-b32-protocol-implementation-tests)
- [16.3.2.1 b.3.2.1. API Protocol Tests](15b-consistency-framework.md#16321-b321-api-protocol-tests)
- [16.3.2.2 b.3.2.2. MQTT Protocol Tests](15b-consistency-framework.md#16322-b322-mqtt-protocol-tests)
- [16.3.2.3 b.3.2.3. KNX Protocol Tests](15b-consistency-framework.md#16323-b323-knx-protocol-tests)
- [16.3.3 b.3.3. Cross-Protocol Consistency Tests](15b-consistency-framework.md#1633-b33-cross-protocol-consistency-tests)
- [16.4 b.4. Implementation Strategy](15b-consistency-framework.md#164-b4-implementation-strategy)
- [16.4.1 b.4.1. Test Organization](15b-consistency-framework.md#1641-b41-test-organization)
- [16.4.2 b.4.2. Test Execution Strategy](15b-consistency-framework.md#1642-b42-test-execution-strategy)
- [16.4.2.1 b.4.2.1. Local Development](15b-consistency-framework.md#16421-b421-local-development)
- [16.4.2.2 b.4.2.2. CI/CD Integration](15b-consistency-framework.md#16422-b422-cicd-integration)
- [16.4.3 b.4.3. Error Reporting Strategy](15b-consistency-framework.md#1643-b43-error-reporting-strategy)
- [16.4.3.1 b.4.3.1. Test Failure Messages](15b-consistency-framework.md#16431-b431-test-failure-messages)
- [16.4.3.2 b.4.3.2. Implementation Suggestions](15b-consistency-framework.md#16432-b432-implementation-suggestions)
- [16.4.4 b.4.4. Tolerance for New Features](15b-consistency-framework.md#1644-b44-tolerance-for-new-features)
- [16.5 b.5. Reporting and Metrics](15b-consistency-framework.md#165-b5-reporting-and-metrics)
- [16.5.1 b.5.1. Consistency Metrics](15b-consistency-framework.md#1651-b51-consistency-metrics)
- [16.5.2 b.5.2. Report Generation](15b-consistency-framework.md#1652-b52-report-generation)
- [16.5.2.1 b.5.2.1. Console Output](15b-consistency-framework.md#16521-b521-console-output)
- [16.5.2.2 b.5.2.2. Markdown Report Generation](15b-consistency-framework.md#16522-b522-markdown-report-generation)
- [16.5.3 b.5.3. Integration with Implementation Status Document](15b-consistency-framework.md#1653-b53-integration-with-implementation-status-document)
- [16.6 b.6. Maintenance and Evolution](15b-consistency-framework.md#166-b6-maintenance-and-evolution)
- [16.6.1 b.6.1. Adding New Commands/Status](15b-consistency-framework.md#1661-b61-adding-new-commandsstatus)
- [16.6.2 b.6.2. Protocol Evolution](15b-consistency-framework.md#1662-b62-protocol-evolution)
- [16.6.3 b.6.3. Continuous Improvement](15b-consistency-framework.md#1663-b63-continuous-improvement)
- [16.7 b.7. Benefits and ROI](15b-consistency-framework.md#167-b7-benefits-and-roi)
- [16.7.1 b.7.1. Immediate Benefits](15b-consistency-framework.md#1671-b71-immediate-benefits)
- [16.7.2 b.7.2. Long-term Benefits](15b-consistency-framework.md#1672-b72-long-term-benefits)
- [16.7.3 b.7.3. Risk Mitigation](15b-consistency-framework.md#1673-b73-risk-mitigation)

17. [Cortex.Mediator Implementation (Server Layer)](16-mediator-implementation-server-layer.md#17-cortexmediator-implementation-server-layer)

- [17.1 Cortex.Mediator Integration and Configuration](16-mediator-implementation-server-layer.md#171-cortexmediator-integration-and-configuration)
- [17.2 Command, Query, and Notification Structure](16-mediator-implementation-server-layer.md#172-command-query-and-notification-structure)
- [17.2.1 Command Example](16-mediator-implementation-server-layer.md#1721-command-example)
- [17.2.2 Query Example](16-mediator-implementation-server-layer.md#1722-query-example)
- [17.2.3 Notification Example](16-mediator-implementation-server-layer.md#1723-notification-example)
- [17.3 Command Validation with FluentValidation](16-mediator-implementation-server-layer.md#173-command-validation-with-fluentvalidation)
- [17.4 Pipeline Behaviors (`/Server/Behaviors`)](16-mediator-implementation-server-layer.md#174-pipeline-behaviors-serverbehaviors)
- [17.4.1 Logging Behavior](16-mediator-implementation-server-layer.md#1741-logging-behavior)
- [17.4.2 Validation Behavior](16-mediator-implementation-server-layer.md#1742-validation-behavior)
- [17.4.3 Performance Behavior](16-mediator-implementation-server-layer.md#1743-performance-behavior)
- [17.5 Communication Layer Integration](16-mediator-implementation-server-layer.md#175-communication-layer-integration)
- [17.6 Status Update Mechanism](16-mediator-implementation-server-layer.md#176-status-update-mechanism)

18. [Cortex.Mediator Command Framework Implementation](16a-cortex-mediator-command-implementation.md#18-cortexmediator-command-framework-implementation)

- [18.1 Implementation Overview](16a-cortex-mediator-command-implementation.md#181-implementation-overview)
- [18.2 Project Structure](16a-cortex-mediator-command-implementation.md#182-project-structure)
- [18.3 Base Interfaces and Common Types](16a-cortex-mediator-command-implementation.md#183-base-interfaces-and-common-types)
- [18.3.1 Command Result Types](16a-cortex-mediator-command-implementation.md#1831-command-result-types)
- [18.3.2 Common Enums](16a-cortex-mediator-command-implementation.md#1832-common-enums)
- [18.4 Global Commands and Queries](16a-cortex-mediator-command-implementation.md#184-global-commands-and-queries)
- [18.4.1 Global Status Queries](16a-cortex-mediator-command-implementation.md#1841-global-status-queries)
- [18.4.2 Global Query Handlers](16a-cortex-mediator-command-implementation.md#1842-global-query-handlers)
- [18.5 Zone Commands](16a-cortex-mediator-command-implementation.md#185-zone-commands)
- [18.5.1 Playback Control Commands](16a-cortex-mediator-command-implementation.md#1851-playback-control-commands)
- [18.6 Status Notifications](16a-cortex-mediator-command-implementation.md#186-status-notifications)
- [18.6.1 Global Status Notifications](16a-cortex-mediator-command-implementation.md#1861-global-status-notifications)
- [18.7 Command Validators](16a-cortex-mediator-command-implementation.md#187-command-validators)
- [18.7.1 Zone Command Validators](16a-cortex-mediator-command-implementation.md#1871-zone-command-validators)

19. [Zone Commands Implementation](16b-zone-commands-implementation.md#19-zone-commands-implementation)

- [19.1 Volume and Mute Commands](16b-zone-commands-implementation.md#191-volume-and-mute-commands)
- [19.2 Track Management Commands](16b-zone-commands-implementation.md#192-track-management-commands)
- [19.3 Playlist Management Commands](16b-zone-commands-implementation.md#193-playlist-management-commands)
- [19.4 Zone Command Validators](16b-zone-commands-implementation.md#194-zone-command-validators)
- [19.5 Zone Command Handlers](16b-zone-commands-implementation.md#195-zone-command-handlers)

20. [Client Commands Implementation](16c-client-commands-implementation.md#20-client-commands-implementation)

- [20.1 Client Volume and Mute Commands](16c-client-commands-implementation.md#201-client-volume-and-mute-commands)
- [20.2 Client Configuration Commands](16c-client-commands-implementation.md#202-client-configuration-commands)
- [20.3 Client Command Validators](16c-client-commands-implementation.md#203-client-command-validators)
- [20.4 Client Command Handlers](16c-client-commands-implementation.md#204-client-command-handlers)
- [20.5 Client Queries](16c-client-commands-implementation.md#205-client-queries)
- [20.6 Client Query Handlers](16c-client-commands-implementation.md#206-client-query-handlers)

21. [Zone Queries and Status Notifications](16d-queries-and-notifications.md#21-zone-queries-and-status-notifications)

- [21.1 Zone Queries](16d-queries-and-notifications.md#211-zone-queries)
- [21.2 Zone Query Handlers](16d-queries-and-notifications.md#212-zone-query-handlers)
- [21.3 Status Notifications](16d-queries-and-notifications.md#213-status-notifications)
- [21.3.1 Zone Status Notifications](16d-queries-and-notifications.md#2131-zone-status-notifications)
- [21.3.2 Client Status Notifications](16d-queries-and-notifications.md#2132-client-status-notifications)
- [21.4 Generic Status Changed Notification](16d-queries-and-notifications.md#214-generic-status-changed-notification)
- [21.5 Notification Handlers Example](16d-queries-and-notifications.md#215-notification-handlers-example)

22. [Integration and Implementation Summary](16e-integration-and-summary.md#22-integration-and-implementation-summary)

- [22.1 Infrastructure Adapter Integration](16e-integration-and-summary.md#221-infrastructure-adapter-integration)
- [22.1.1 MQTT Service Integration](16e-integration-and-summary.md#2211-mqtt-service-integration)
- [22.1.2 KNX Service Integration](16e-integration-and-summary.md#2212-knx-service-integration)
- [22.1.3 API Controller Integration](16e-integration-and-summary.md#2213-api-controller-integration)
- [22.2 Dependency Injection Configuration](16e-integration-and-summary.md#222-dependency-injection-configuration)
- [22.3 Testing Strategy](16e-integration-and-summary.md#223-testing-strategy)
- [22.3.1 Unit Tests for Commands and Handlers](16e-integration-and-summary.md#2231-unit-tests-for-commands-and-handlers)
- [22.3.2 Integration Tests](16e-integration-and-summary.md#2232-integration-tests)
- [22.4 Overview](16e-integration-and-summary.md#224-overview)
- [22.4.1 Key Benefits](16e-integration-and-summary.md#2241-key-benefits)
- [22.4.2 Implementation Plan](16e-integration-and-summary.md#2242-implementation-plan)

23. [Testing Strategy](18-testing-strategy.md#23-testing-strategy)

- [23.1 Test Types and Goals](18-testing-strategy.md#231-test-types-and-goals)
- [23.2 Specific Component Testing Approaches](18-testing-strategy.md#232-specific-component-testing-approaches)
- [23.3 Specific Test Scenario Examples](18-testing-strategy.md#233-specific-test-scenario-examples)
- [23.4 Supporting Strategies](18-testing-strategy.md#234-supporting-strategies)

24. [Dependencies](20-dependencies.md#24-dependencies)

- [24.1 .NET Framework](20-dependencies.md#241-net-framework)
- [24.2 Core NuGet Packages](20-dependencies.md#242-core-nuget-packages)
- [24.2.1 Application Framework & Utilities](20-dependencies.md#2421-application-framework-utilities)
- [24.2.2 Resilience](20-dependencies.md#2422-resilience)
- [24.2.3 Logging](20-dependencies.md#2423-logging)
- [24.2.4 External System Integration](20-dependencies.md#2424-external-system-integration)
- [24.2.5 Observability (OpenTelemetry)](20-dependencies.md#2425-observability-opentelemetry)
- [24.2.6 Code Quality & Analysis](20-dependencies.md#2426-code-quality-analysis)
- [24.2.7 Testing Dependencies](20-dependencies.md#2427-testing-dependencies)
- [24.3 Centralized Package Management (`Directory.Packages.props`)](20-dependencies.md#243-centralized-package-management-directorypackagesprops)
- [24.4 Dependency Management Strategy](20-dependencies.md#244-dependency-management-strategy)
- [24.5 Native Dependencies](20-dependencies.md#245-native-dependencies)

25. [DRY Transformation Architecture](22-dry-transformation-architecture.md#25-dry-transformation-architecture)

- [25.1 Overview](22-dry-transformation-architecture.md#251-overview)
- [25.2 Architectural Principles](22-dry-transformation-architecture.md#252-architectural-principles)
- [25.2.1 Single Source of Truth](22-dry-transformation-architecture.md#2521-single-source-of-truth)
- [25.2.2 Type Safety](22-dry-transformation-architecture.md#2522-type-safety)
- [25.2.3 Blueprint Integration](22-dry-transformation-architecture.md#2523-blueprint-integration)
- [25.2.4 Automated Consistency Validation](22-dry-transformation-architecture.md#2524-automated-consistency-validation)
- [25.2.5 Developer Experience](22-dry-transformation-architecture.md#2525-developer-experience)
- [25.3 Attribute System Architecture](22-dry-transformation-architecture.md#253-attribute-system-architecture)
- [25.3.1 StatusIdAttribute](22-dry-transformation-architecture.md#2531-statusidattribute)
- [25.3.2 CommandAttribute](22-dry-transformation-architecture.md#2532-commandattribute)
- [25.4 Registry System Architecture](22-dry-transformation-architecture.md#254-registry-system-architecture)
- [25.4.1 StatusIdRegistry](22-dry-transformation-architecture.md#2541-statusidregistry)
- [25.4.2 CommandIdRegistry](22-dry-transformation-architecture.md#2542-commandidregistry)
- [25.5 Implementation Categories](22-dry-transformation-architecture.md#255-implementation-categories)
- [25.5.1 Status Notification System (Blueprint Compliant)](22-dry-transformation-architecture.md#2551-status-notification-system-blueprint-compliant)
- [25.5.1.1 Client Status Notifications (7 Classes)](22-dry-transformation-architecture.md#25511-client-status-notifications-7-classes)
- [25.5.1.2 Zone Status Notifications (6 Classes)](22-dry-transformation-architecture.md#25512-zone-status-notifications-6-classes)
- [25.5.1.3 Global Status Notifications (5 Classes)](22-dry-transformation-architecture.md#25513-global-status-notifications-5-classes)
- [25.5.1.4 Additional Status Notifications (3 Classes)](22-dry-transformation-architecture.md#25514-additional-status-notifications-3-classes)
- [25.5.2 Command System (Blueprint Compliant)](22-dry-transformation-architecture.md#2552-command-system-blueprint-compliant)
- [25.5.2.1 Client Commands (8 Classes)](22-dry-transformation-architecture.md#25521-client-commands-8-classes)
- [25.5.2.2 Zone Playback Commands (3 Classes)](22-dry-transformation-architecture.md#25522-zone-playback-commands-3-classes)
- [25.5.2.3 Zone Volume Commands (5 Classes)](22-dry-transformation-architecture.md#25523-zone-volume-commands-5-classes)
- [25.5.2.4 Zone Track Commands (6 Classes)](22-dry-transformation-architecture.md#25524-zone-track-commands-6-classes)
- [25.5.2.5 Zone Playlist Commands (7 Classes)](22-dry-transformation-architecture.md#25525-zone-playlist-commands-7-classes)
- [25.5.2.6 Additional Commands (3 Classes)](22-dry-transformation-architecture.md#25526-additional-commands-3-classes)
- [25.6 Automated Consistency Validation](22-dry-transformation-architecture.md#256-automated-consistency-validation)
- [25.6.1 Comprehensive Test Suite](22-dry-transformation-architecture.md#2561-comprehensive-test-suite)
- [25.6.1.1 Command Framework Consistency Tests](22-dry-transformation-architecture.md#25611-command-framework-consistency-tests)
- [25.6.1.2 Cross-Protocol Consistency Tests](22-dry-transformation-architecture.md#25612-cross-protocol-consistency-tests)
- [25.6.2 Reverse-Direction Testing](22-dry-transformation-architecture.md#2562-reverse-direction-testing)
- [25.6.3 Obsolete Implementation Detection](22-dry-transformation-architecture.md#2563-obsolete-implementation-detection)
- [25.6.4 Blueprint Compliance Validation](22-dry-transformation-architecture.md#2564-blueprint-compliance-validation)
- [25.7 Integration Patterns](22-dry-transformation-architecture.md#257-integration-patterns)
- [25.7.1 Notification Handler Pattern](22-dry-transformation-architecture.md#2571-notification-handler-pattern)
- [25.7.2 Command Processing Pattern](22-dry-transformation-architecture.md#2572-command-processing-pattern)
- [25.7.3 Status Factory Pattern](22-dry-transformation-architecture.md#2573-status-factory-pattern)
- [25.8 Quality Assurance and Metrics](22-dry-transformation-architecture.md#258-quality-assurance-and-metrics)
- [25.8.1 Compile-Time Validation](22-dry-transformation-architecture.md#2581-compile-time-validation)
- [25.8.2 Runtime Validation](22-dry-transformation-architecture.md#2582-runtime-validation)
- [25.8.3 Architectural Cleanup Results](22-dry-transformation-architecture.md#2583-architectural-cleanup-results)
- [25.8.4 Code Quality Metrics](22-dry-transformation-architecture.md#2584-code-quality-metrics)
- [25.8.5 Performance Characteristics](22-dry-transformation-architecture.md#2585-performance-characteristics)
- [25.9 Future Extensibility](22-dry-transformation-architecture.md#259-future-extensibility)
- [25.9.1 Adding New Notifications](22-dry-transformation-architecture.md#2591-adding-new-notifications)
- [25.9.2 Adding New Commands](22-dry-transformation-architecture.md#2592-adding-new-commands)
- [25.9.3 Automatic Integration](22-dry-transformation-architecture.md#2593-automatic-integration)
- [25.10 Conclusion](22-dry-transformation-architecture.md#2510-conclusion)
- [25.10.1 Architectural Excellence](22-dry-transformation-architecture.md#25101-architectural-excellence)
- [25.10.2 Developer Experience](22-dry-transformation-architecture.md#25102-developer-experience)
- [25.10.3 Quality Metrics](22-dry-transformation-architecture.md#25103-quality-metrics)
- [25.10.4 Architectural Impact](22-dry-transformation-architecture.md#25104-architectural-impact)

26. [a. Fluent Blueprint-as-Code](22a-fluent-blueprint-as-code.md#26-a-fluent-blueprint-as-code)

- [26.1 Overview](22a-fluent-blueprint-as-code.md#261-overview)
- [26.2 Problem](22a-fluent-blueprint-as-code.md#262-problem)
- [26.3 Solution: Fluent Blueprint DSL](22a-fluent-blueprint-as-code.md#263-solution-fluent-blueprint-dsl)
- [26.3.1 Core Example](22a-fluent-blueprint-as-code.md#2631-core-example)
- [26.4 DSL API](22a-fluent-blueprint-as-code.md#264-dsl-api)
- [26.4.1 Fluent Chain Structure](22a-fluent-blueprint-as-code.md#2641-fluent-chain-structure)
- [26.4.2 Methods](22a-fluent-blueprint-as-code.md#2642-methods)
- [26.5 Design Principles](22a-fluent-blueprint-as-code.md#265-design-principles)
- [26.5.1 Explicit Inclusion](22a-fluent-blueprint-as-code.md#2651-explicit-inclusion)
- [26.5.2 Explicit Exclusion for Clarity](22a-fluent-blueprint-as-code.md#2652-explicit-exclusion-for-clarity)
- [26.5.3 Required by Default](22a-fluent-blueprint-as-code.md#2653-required-by-default)
- [26.6 Usage in Tests](22a-fluent-blueprint-as-code.md#266-usage-in-tests)
- [26.6.1 Automatic Validation](22a-fluent-blueprint-as-code.md#2661-automatic-validation)
- [26.6.2 Query API](22a-fluent-blueprint-as-code.md#2662-query-api)
- [26.7 Benefits](22a-fluent-blueprint-as-code.md#267-benefits)
- [26.8 Benefits](22a-fluent-blueprint-as-code.md#268-benefits)
- [26.9 Implementation Strategy](22a-fluent-blueprint-as-code.md#269-implementation-strategy)
- [26.10 Future Extensions](22a-fluent-blueprint-as-code.md#2610-future-extensions)

27. [Deployment and Operations](23-deployment-and-operations.md#27-deployment-and-operations)

- [27.1 Deployment Options](23-deployment-and-operations.md#271-deployment-options)
- [27.1.1 Docker Deployment (Recommended)](23-deployment-and-operations.md#2711-docker-deployment-recommended)
- [27.1.2 Kubernetes Deployment](23-deployment-and-operations.md#2712-kubernetes-deployment)
- [27.1.3 Bare Metal / Virtual Machine Deployment](23-deployment-and-operations.md#2713-bare-metal-virtual-machine-deployment)
- [27.2 Monitoring and Observability](23-deployment-and-operations.md#272-monitoring-and-observability)
- [27.2.1 Logging](23-deployment-and-operations.md#2721-logging)
- [27.2.2 Metrics](23-deployment-and-operations.md#2722-metrics)
- [27.2.3 Distributed Tracing](23-deployment-and-operations.md#2723-distributed-tracing)
- [27.2.4 Health Checks](23-deployment-and-operations.md#2724-health-checks)
- [27.3 Operational Procedures](23-deployment-and-operations.md#273-operational-procedures)
- [27.3.1 Deployment/Update Process (Docker Compose Example)](23-deployment-and-operations.md#2731-deploymentupdate-process-docker-compose-example)
- [27.3.2 Configuration Updates](23-deployment-and-operations.md#2732-configuration-updates)
- [27.3.3 Backup and Restore](23-deployment-and-operations.md#2733-backup-and-restore)
- [27.3.4 Troubleshooting](23-deployment-and-operations.md#2734-troubleshooting)
- [27.3.5 Scaling](23-deployment-and-operations.md#2735-scaling)
- [27.4 Security Considerations](23-deployment-and-operations.md#274-security-considerations)
- [27.4.1 Network Security](23-deployment-and-operations.md#2741-network-security)
- [27.4.2 Authentication and Authorization](23-deployment-and-operations.md#2742-authentication-and-authorization)
- [27.4.3 Secrets Management](23-deployment-and-operations.md#2743-secrets-management)

28. [Docker Infrastructure](25-docker-infrastructure.md#28-docker-infrastructure)

- [28.1 Container Architecture Overview](25-docker-infrastructure.md#281-container-architecture-overview)
- [28.2 `snapserver` Container Customization](25-docker-infrastructure.md#282-snapserver-container-customization)
- [28.3 `snapdog` Container (`/docker/snapdog/Dockerfile`)](25-docker-infrastructure.md#283-snapdog-container-dockersnapdogdockerfile)
- [28.4 Docker Compose Configuration (Production Example)](25-docker-infrastructure.md#284-docker-compose-configuration-production-example)
- [28.5 Docker Compose Profiles](25-docker-infrastructure.md#285-docker-compose-profiles)
- [28.6 Environment Variables for Production](25-docker-infrastructure.md#286-environment-variables-for-production)

29. [Appendices](30-appendices.md#29-appendices)

- [29.1 Glossary](30-appendices.md#291-glossary)
- [29.2 References](30-appendices.md#292-references)
- [29.2.1 External Systems & Libraries](30-appendices.md#2921-external-systems-libraries)
- [29.2.2 .NET & Core Libraries](30-appendices.md#2922-net-core-libraries)
- [29.2.3 Analysis & Style Tools](30-appendices.md#2923-analysis-style-tools)
- [29.2.4 Design Patterns & Principles](30-appendices.md#2924-design-patterns-principles)
- [29.3 KNX DPT Value Mapping Summary](30-appendices.md#293-knx-dpt-value-mapping-summary)
- [29.4 Error Codes Reference](30-appendices.md#294-error-codes-reference)

30. [Table of Contents](index.md#30-table-of-contents)
